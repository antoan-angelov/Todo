<!DOCTYPE html>
<html>
<head>
	<script src="bower_components/jquery/dist/jquery.min.js"></script>
	<link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap-theme.min.css">
	<link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css">
	<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
	<script src="bower_components/lodash/dist/lodash.min.js"></script>
	<script src="main.js"></script>
	<title></title>
	<style> 
	#input-task, #input-description {
		margin-bottom: 10px;
		margin-top: 10px;
	}

	#table-cont {
		width: 600px;
		float:left;
		background: white;
	}

	#user-info {
		float:left;
		width: 240px;
		height: 260px;
		text-align: center;
		margin-left: 15px;
	}

	.toolbar {
		margin: 15px;
	}

	#drop_zone {
		width: 280px;
		height: 180px;
		margin: 0 auto;
		text-align: center;
	}

	.drop-spot {
		border: 2px black dashed;
		padding-top: 70px;
	}

	#input-username {
		width: 180px;
		margin: 10px auto;
	}

	#color-cont {
		text-align: center;
	}
	.thumb {
		height: 180px;
		border: 1px solid #000;
		margin: 10px 5px 0 0;
	}

	#avatar {
		width: 180px;
		height: 180px;
	}

	#username {
		margin-top: 15px;
	}
	</style>
</head>
<body>

	<div class="toolbar">
		<button class="btn btn-primary" data-toggle="modal" data-target="#myModal">
		  Add new task
		</button>

		<button class="btn btn-primary" data-toggle="modal" data-target="#settingsModal">
		  Settings
		</button>
	</div>

	<div id="table-cont">
		<table class="table table-hover table-bordered table-striped" >
			<thead>
				<tr>
					<th>Task</th>
					<th>Date</th>
					<th>Starred</th>
					<th>Options</th>
				</tr>
			</thead>
			<tbody ondrop="drop(event)" ondragover="allowDrop(event)">
			</tbody>
		</table>
	</div>

	<div id="user-info" class="well">
		<img id="avatar" class="thumb" src="" />
		<div id="username"></div>
	</div>

	<!-- Settings Modal -->
	<div class="modal fade" id="settingsModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	  <div class="modal-dialog">
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
	        <h4 class="modal-title" id="myModalLabel">Settings</h4>
	      </div>
	      <div class="modal-body">
      		<div class="drop-spot" id="drop_zone">Drop avatar here</div>
			<output id="list"></output>
	      	<input id="input-username" type="text" class="form-control" placeholder="Username">
	      	<div id="color-cont"><label for="bgcolor">Background color:</label> <input type="color" id="bgcolor" name="bgcolor"></div>
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	        <button id="btn-save-settings" type="button" data-dismiss="modal" class="btn btn-primary">Save changes</button>
	      </div>
	    </div>
	  </div>
	</div>

	<!-- Add or Edit Task Modal -->
	<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	  <div class="modal-dialog">
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
	        <h4 class="modal-title" id="myModalLabel">Task</h4>
	      </div>
	      <div class="modal-body">
	      	<input id="input-task" type="text" class="form-control" placeholder="Task">

			Deadline: <input id="input-date" type="date" name="bday">

			<textarea id="input-description" class="form-control" rows="3" placeholder="Description"></textarea>

	        <div class="checkbox">
			   <label>
			     <input id="input-checkbox" type="checkbox"> Starred
			   </label>
			 </div>
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	        <button id="btn-add-task" type="button" data-dismiss="modal" class="btn btn-primary">Save changes</button>
	      </div>
	    </div>
	  </div>
	</div>

	<script>
	function setSettingsAvatar(data) {
		document.getElementById('drop_zone').innerHTML = ['<img class="thumb" src="', 
	      		data, '">'].join('');
	      $("#drop_zone").removeClass("drop-spot");
	    //  console.log("setSettingsAvatar", ['<img class="thumb" src="', data, '">'].join(''));
	}

	  function handleFileSelect(evt) {
	    evt.stopPropagation();
	    evt.preventDefault();

	    var files = evt.dataTransfer.files; // FileList object.

	    // files is a FileList of File objects. List some properties.
	    var output = [];
	    for (var i = 0, f; f = files[i]; i++) {

	    	// Only process image files.
			if (!f.type.match('image.*')) {
				continue;
			}

			var reader = new FileReader();

		      // Closure to capture the file information.
		      reader.onload = (function(theFile) {
		        return function(e) {
		          // Render thumbnail.
		          //var span = document.createElement('span');
		          setSettingsAvatar(e.target.result);

		          //document.getElementById('list').insertBefore(span, null);
		        };
		      })(f);

		      // Read in the image file as a data URL.
		      reader.readAsDataURL(f);

	      /*output.push('<li><strong>', escape(f.name), '</strong> (', f.type || 'n/a', ') - ',
	                  f.size, ' bytes, last modified: ',
	                  f.lastModifiedDate ? f.lastModifiedDate.toLocaleDateString() : 'n/a',
	                  '</li>');*/
	    }
	    //document.getElementById('list').innerHTML = '<ul>' + output.join('') + '</ul>';
	  }

	  function handleDragOver(evt) {
	    evt.stopPropagation();
	    evt.preventDefault();
	    evt.dataTransfer.dropEffect = 'copy'; // Explicitly show this is a copy.
	  }

	  // Setup the dnd listeners.
	  var dropZone = document.getElementById('drop_zone');
	  dropZone.addEventListener('dragover', handleDragOver, false);
	  dropZone.addEventListener('drop', handleFileSelect, false);
	</script>

</body>
</html>